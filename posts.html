<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Posts | Side Hustle Finder</title>
  <link rel="stylesheet" href="styles.css">
  <script defer src="firebase.js"></script>
  <script defer src="auth.js"></script>
  <script defer src="posts.js"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2359381175785200"
     crossorigin="anonymous"></script>
</head>
<body>
  <nav class="navbar">
    <a href="index.html" class="logo">ðŸ’¸ SideHustle</a>
    <div id="nav-links">
      <a href="quiz.html">Find Hustle</a>
      <a href="posts.html">Posts</a>
      <a href="about.html">About</a>
      <button id="login-btn">Login</button>
      <button id="logout-btn" style="display:none;">Logout</button>
    </div>
  </nav>

  <main class="container">
    <h2>ðŸ“£ Community Feedback</h2>

    <!-- Shown only when logged in -->
    <div id="postFormContainer" style="display:none;">
      <textarea id="postText" placeholder="Share how a hustle went..." rows="4"></textarea>
      <button id="postBtn">Post</button>
    </div>

    <div id="postsList"></div>
  </main>
    <script>
    // --- Post new feedback ---
const postBtn = document.getElementById('postBtn');
if (postBtn) {
  postBtn.addEventListener('click', async () => {
    const text = document.getElementById('postText').value.trim();
    if (!text) return;

    await db.collection('posts').add({
      text,
      uid: auth.currentUser.uid,
      displayName: auth.currentUser.displayName || 'Anon',
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    document.getElementById('postText').value = '';
  });
}

// --- Render all posts in real time ---
const postsList = document.getElementById('postsList');
if (postsList) {
  db.collection('posts').orderBy('timestamp', 'desc').onSnapshot(snapshot => {
    postsList.innerHTML = '';
    snapshot.forEach(doc => {
      const d = doc.data();
      const div = document.createElement('div');
      div.className = 'post';
      div.innerHTML = `
        <strong>${d.displayName}</strong><br>
        <p>${d.text}</p>
        <small>${d.timestamp ? d.timestamp.toDate().toLocaleString() : ''}</small>
      `;
      postsList.appendChild(div);
    });
  });
}

    
    
    
    </script>
    <script defer src="firebase.js"></script>
<script defer src="auth.js"></script>   <!-- or js/auth.js -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js"></script>
<script defer src="firebase.js"></script>
<script defer src="auth.js"></script>

</body>
</html>
